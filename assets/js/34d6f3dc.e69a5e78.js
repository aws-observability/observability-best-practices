"use strict";(self.webpackChunkobservability_best_practices=self.webpackChunkobservability_best_practices||[]).push([[4442],{94600:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>r,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var t=n(74848),s=n(28453);const i={},r="Using Redshift in Amazon Managed Grafana",o={id:"recipes/recipes/amg-redshift-plugin",title:"Using Redshift in Amazon Managed Grafana",description:"In this recipe we show you how to use Amazon Redshift\u2014a petabyte-scale data",source:"@site/docs/recipes/recipes/amg-redshift-plugin.md",sourceDirName:"recipes/recipes",slug:"/recipes/recipes/amg-redshift-plugin",permalink:"/observability-best-practices/docs/recipes/recipes/amg-redshift-plugin",draft:!1,unlisted:!1,editUrl:"https://github.com/aws-observability/observability-best-practices/docs/recipes/recipes/amg-redshift-plugin.md",tags:[],version:"current",frontMatter:{}},d={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Infrastructure",id:"infrastructure",level:2},{value:"Usage",id:"usage",level:2},{value:"Cleanup",id:"cleanup",level:2}];function h(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.h1,{id:"using-redshift-in-amazon-managed-grafana",children:"Using Redshift in Amazon Managed Grafana"}),"\n",(0,t.jsxs)(a.p,{children:["In this recipe we show you how to use ",(0,t.jsx)(a.a,{href:"https://aws.amazon.com/redshift/",children:"Amazon Redshift"}),"\u2014a petabyte-scale data\nwarehouse service using standard SQL\u2014in ",(0,t.jsx)(a.a,{href:"https://aws.amazon.com/grafana/",children:"Amazon Managed Grafana"}),". This integration\nis enabled by the ",(0,t.jsx)(a.a,{href:"https://grafana.com/grafana/plugins/grafana-redshift-datasource/",children:"Redshift data source for Grafana"}),", an open source\nplugin available for you to use in any DIY Grafana instance as well as\npre-installed in Amazon Managed Grafana."]}),"\n",(0,t.jsx)(a.admonition,{type:"note",children:(0,t.jsx)(a.p,{children:"This guide will take approximately 10 minutes to complete."})}),"\n",(0,t.jsx)(a.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsx)(a.li,{children:"You have admin access to Amazon Redshift from your account."}),"\n",(0,t.jsxs)(a.li,{children:["Tag your Amazon Redshift cluster with ",(0,t.jsx)(a.code,{children:"GrafanaDataSource: true"}),"."]}),"\n",(0,t.jsxs)(a.li,{children:["In order to benefit from the service-managed policies, create the database\ncredentials in one of the following ways:","\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsxs)(a.li,{children:["If you want to use the default mechanism, that is, the temporary credentials\noption, to authenticate against the Redshift database, you must create a database\nuser named ",(0,t.jsx)(a.code,{children:"redshift_data_api_user"}),"."]}),"\n",(0,t.jsxs)(a.li,{children:["If you want to use the credentials from Secrets Manager, you must tag the\nsecret with ",(0,t.jsx)(a.code,{children:"RedshiftQueryOwner: true"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(a.admonition,{type:"tip",children:(0,t.jsxs)(a.p,{children:["For more information on how to work with the service-managed or custom policies,\nsee the ",(0,t.jsx)(a.a,{href:"https://docs.aws.amazon.com/grafana/latest/userguide/security_iam_id-based-policy-examples.html",children:"examples in the Amazon Managed Grafana docs"}),"."]})}),"\n",(0,t.jsx)(a.h2,{id:"infrastructure",children:"Infrastructure"}),"\n",(0,t.jsxs)(a.p,{children:["We need a Grafana instance, so go ahead and set up a new ",(0,t.jsx)(a.a,{href:"https://console.aws.amazon.com/grafana/home#/workspaces",children:"Amazon Managed Grafana\nworkspace"}),", for example by using the ",(0,t.jsx)(a.a,{href:"https://aws.amazon.com/blogs/mt/amazon-managed-grafana-getting-started/",children:"Getting Started"})," guide,\nor use an existing one."]}),"\n",(0,t.jsx)(a.admonition,{type:"note",children:(0,t.jsx)(a.p,{children:"To use AWS data source configuration, first go to the Amazon Managed Grafana\nconsole to enable service-mananged IAM roles that grant the workspace the\nIAM policies necessary to read the Athena resources."})}),"\n",(0,t.jsx)(a.p,{children:'To set up the Athena data source, use the left-hand toolbar and choose the\nlower AWS icon and then choose "Redshift". Select your default region you want\nthe plugin to discover the Redshift data source to use, and then select the\naccounts that you want, and finally choose "Add data source".'}),"\n",(0,t.jsx)(a.p,{children:"Alternatively, you can manually add and configure the Redshift data source by\nfollowing these steps:"}),"\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsx)(a.li,{children:'Click on the "Configurations" icon on the left-hand toolbar and then on "Add data source".'}),"\n",(0,t.jsx)(a.li,{children:'Search for "Redshift".'}),"\n",(0,t.jsx)(a.li,{children:"[OPTIONAL] Configure the authentication provider (recommended: workspace IAM\nrole)."}),"\n",(0,t.jsx)(a.li,{children:'Provide the "Cluster Identifier", "Database", and "Database User" values.'}),"\n",(0,t.jsx)(a.li,{children:'Click "Save & test".'}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"You should see something like the following:"}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"Screen shot of the Redshift data source config",src:n(67589).A+"",width:"1000",height:"1020"})}),"\n",(0,t.jsx)(a.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsxs)(a.p,{children:["We will be using the ",(0,t.jsx)(a.a,{href:"https://github.com/awslabs/amazon-redshift-monitoring",children:"Redshift Advance Monitoring"})," setup.\nSince all is available out of the box, there's nothing else to configure at\nthis point."]}),"\n",(0,t.jsx)(a.p,{children:"You can import the Redshift monitoring dashboard, included in the Redshift\nplugin. Once imported you should see something like this:"}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"Screen shot of the Redshift dashboard in AMG",src:n(74229).A+"",width:"2000",height:"1039"})}),"\n",(0,t.jsx)(a.p,{children:"From here, you can use the following guides to create your own dashboard in\nAmazon Managed Grafana:"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"https://docs.aws.amazon.com/grafana/latest/userguide/dashboard-overview.html",children:"User Guide: Dashboards"})}),"\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"https://grafana.com/docs/grafana/latest/best-practices/best-practices-for-creating-dashboards/",children:"Best practices for creating dashboards"})}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"That's it, congratulations you've learned how to use Redshift from Grafana!"}),"\n",(0,t.jsx)(a.h2,{id:"cleanup",children:"Cleanup"}),"\n",(0,t.jsx)(a.p,{children:"Remove the Redshift database you've been using and then\nthe Amazon Managed Grafana workspace by removing it from the console."})]})}function l(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},67589:(e,a,n)=>{n.d(a,{A:()=>t});const t=n.p+"assets/images/amg-plugin-redshift-ds-9e1b9a42a1001c2f158a3aca2e2e5fb9.png"},74229:(e,a,n)=>{n.d(a,{A:()=>t});const t=n.p+"assets/images/amg-redshift-mon-dashboard-e1cda979f6c8371778bf9dbc875a280f.png"},28453:(e,a,n)=>{n.d(a,{R:()=>r,x:()=>o});var t=n(96540);const s={},i=t.createContext(s);function r(e){const a=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(i.Provider,{value:a},e.children)}}}]);