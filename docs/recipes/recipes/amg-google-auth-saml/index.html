<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-recipes/recipes/amg-google-auth-saml" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Configure Google Workspaces authentication with Amazon Managed Grafana using SAML | AWS Observability best practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-observability.github.io/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Configure Google Workspaces authentication with Amazon Managed Grafana using SAML | AWS Observability best practices"><meta data-rh="true" name="description" content="In this guide, we will walk through how you can setup Google Workspaces as an"><meta data-rh="true" property="og:description" content="In this guide, we will walk through how you can setup Google Workspaces as an"><link data-rh="true" rel="icon" href="/observability-best-practices/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-observability.github.io/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/ja/docs/recipes/recipes/amg-google-auth-saml" hreflang="ja"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/observability-best-practices/blog/rss.xml" title="AWS Observability best practices RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/observability-best-practices/blog/atom.xml" title="AWS Observability best practices Atom Feed"><link rel="stylesheet" href="/observability-best-practices/assets/css/styles.2859e3e9.css">
<script src="/observability-best-practices/assets/js/runtime~main.e21a82ab.js" defer="defer"></script>
<script src="/observability-best-practices/assets/js/main.de3a62b2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/observability-best-practices/"><div class="navbar__logo"><img src="/observability-best-practices/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/observability-best-practices/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AWS Observability Best Practices</b></a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/home">Home</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/guides/">Guides</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/signals/alarms">Signals</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/tools/observability_accelerator">Tools</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/recipes/">Recipes</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/faq/adot">FAQ</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/patterns/multiaccount">Patterns</a><a class="navbar__item navbar__link" href="/observability-best-practices/docs/contributors">Contributors</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/observability-best-practices/ja/docs/recipes/recipes/amg-google-auth-saml" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><a href="https://github.com/aws-observability/observability-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Configure Google Workspaces authentication with Amazon Managed Grafana using SAML</h1>
<p>In this guide, we will walk through how you can setup Google Workspaces as an
identity provider (IdP) for Amazon Managed Grafana using SAML v2.0 protocol.</p>
<p>In order to follow this guide you need to create a paid <a href="https://workspace.google.com/" target="_blank" rel="noopener noreferrer">Google Workspaces</a>
account in addition to having an <a href="https://docs.aws.amazon.com/grafana/latest/userguide/getting-started-with-AMG.html#AMG-getting-started-workspace" target="_blank" rel="noopener noreferrer">Amazon Managed Grafana workspace</a> created.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-amazon-managed-grafana-workspace">Create Amazon Managed Grafana workspace<a class="hash-link" aria-label="Direct link to Create Amazon Managed Grafana workspace" title="Direct link to Create Amazon Managed Grafana workspace" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml#create-amazon-managed-grafana-workspace">​</a></h3>
<p>Log into the Amazon Managed Grafana console and click <strong>Create workspace.</strong> In the following screen,
provide a workspace name as shown below. Then click <strong>Next</strong>:</p>
<p><img decoding="async" loading="lazy" alt="Create Workspace - Specify workspace details" src="/observability-best-practices/assets/images/1-f980b1293dab6b586bf09eec9ab87925.png" width="1130" height="513" class="img_ev3q"></p>
<p>In the <strong>Configure settings</strong> page, select <strong>Security Assertion Markup Language (SAML)</strong>
option so you can configure a SAML based Identity Provider for users to log in:</p>
<p><img decoding="async" loading="lazy" alt="Create Workspace - Configure settings" src="/observability-best-practices/assets/images/2-22136261aee94d69823499acc55e504b.png" width="1106" height="695" class="img_ev3q"></p>
<p>Select the data sources you want to choose and click <strong>Next</strong>:
<img decoding="async" loading="lazy" alt="Create Workspace - Permission settings" src="/observability-best-practices/assets/images/3-5b8c9005451c082aeccc189ff68798c7.png" width="1115" height="951" class="img_ev3q"></p>
<p>Click on <strong>Create workspace</strong> button in the <strong>Review and create</strong> screen:
<img decoding="async" loading="lazy" alt="Create Workspace - Review settings" src="/observability-best-practices/assets/images/4-97f81696f2c066ddc7f72d23ee4d9b3e.png" width="1113" height="1105" class="img_ev3q"></p>
<p>This will create a new Amazon Managed Grafana workspace as shown below:</p>
<p><img decoding="async" loading="lazy" alt="Create Workspace - Create AMG workspace" src="/observability-best-practices/assets/images/5-790f6db8245706d375af6c8c243c3f68.png" width="1580" height="945" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-google-workspaces">Configure Google Workspaces<a class="hash-link" aria-label="Direct link to Configure Google Workspaces" title="Direct link to Configure Google Workspaces" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml#configure-google-workspaces">​</a></h3>
<p>Login to Google Workspaces with Super Admin permissions and go
to <strong>Web and mobile apps</strong> under <strong>Apps</strong> section. There, click on <strong>Add App</strong>
and select <strong>Add custom SAML app.</strong> Now give the app a name as shown below.
Click <strong>CONTINUE.</strong>:</p>
<p><img decoding="async" loading="lazy" alt="Google Workspace - Add custom SAML app - App details" src="/observability-best-practices/assets/images/6-a121c9c5bedfdc6b37b61ad51ef9af4c.png" width="1353" height="724" class="img_ev3q"></p>
<p>On the next screen, click on <strong>DOWNLOAD METADATA</strong> button to download the SAML metadata file. Click <strong>CONTINUE.</strong></p>
<p><img decoding="async" loading="lazy" alt="Google Workspace - Add custom SAML app - Download Metadata" src="/observability-best-practices/assets/images/7-42d7f60cbd79b50cc9b818bdfd79acc8.png" width="1350" height="1059" class="img_ev3q"></p>
<p>On the next screen, you will see the ACS URL, Entity ID and Start URL fields.
You can get the values for these fields from the Amazon Managed Grafana console.</p>
<p>Select <strong>EMAIL</strong> from the drop down in the <strong>Name ID format</strong> field and select <strong>Basic Information &gt; Primary email</strong> in the <strong>Name ID</strong> field.</p>
<p>Click <strong>CONTINUE.</strong>
<img decoding="async" loading="lazy" alt="Google Workspace - Add custom SAML app - Service provider details" src="/observability-best-practices/assets/images/8-3160a57b7375ac768ccd56f4167856b8.png" width="1349" height="914" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="AMG - SAML Configuration details" src="/observability-best-practices/assets/images/9-68f1e10ca2338ff9361f079379c22ccb.png" width="1531" height="1183" class="img_ev3q"></p>
<p>In the <strong>Attribute mapping</strong> screen, make the mapping between <strong>Google Directory attributes</strong> and <strong>App attributes</strong> as shown in the screenshot below</p>
<p><img decoding="async" loading="lazy" alt="Google Workspace - Add custom SAML app - Attribute mapping" src="/observability-best-practices/assets/images/10-5daccd292f8f8dfeff8642c1770ebcf6.png" width="1351" height="693" class="img_ev3q"></p>
<p>For users logging in through Google authentication to have <strong>Admin</strong> privileges
in <strong>Amazon Managed Grafana</strong>, set the <strong>Department</strong> field’s value as <strong><em>monitoring</em>.</strong> You can choose any field and any value for this. Whatever you choose to use on the Google Workspaces side, make sure you make the mapping on Amazon Managed Grafana SAML settings to reflect that.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upload-saml-metadata-into-amazon-managed-grafana">Upload SAML metadata into Amazon Managed Grafana<a class="hash-link" aria-label="Direct link to Upload SAML metadata into Amazon Managed Grafana" title="Direct link to Upload SAML metadata into Amazon Managed Grafana" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml#upload-saml-metadata-into-amazon-managed-grafana">​</a></h3>
<p>Now in the Amazon Managed Grafana console, click <strong>Upload or copy/paste</strong> option
and select <strong>Choose file</strong> button to upload the SAML metadata file downloaded
from Google Workspaces, earlier.</p>
<p>In the <strong>Assertion mapping</strong> section, type in <strong>Department</strong> in the
<strong>Assertion attribute role</strong> field and <strong>monitoring</strong> in the <strong>Admin role values</strong> field.
This will allow users logging in with <strong>Department</strong> as <strong>monitoring</strong> to
have <strong>Admin</strong> privileges in Grafana so they can perform administrator duties
such as creating dashboards and datasources.</p>
<p>Set values under <strong>Additional settings - optional</strong> section as shown in the
screenshot below. Click on <strong>Save SAML configuration</strong>:</p>
<p><img decoding="async" loading="lazy" alt="AMG SAML - Assertion mapping" src="/observability-best-practices/assets/images/11-dc9745eff63571ecae641cc00a8ed025.png" width="1526" height="818" class="img_ev3q"></p>
<p>Now Amazon Managed Grafana is set up to authenticate users using Google Workspaces.</p>
<p>When users login, they will be redirected to the Google login page like so:</p>
<p><img decoding="async" loading="lazy" alt="Google Workspace - Google sign in" src="/observability-best-practices/assets/images/12-0eaca88915eeaa464350145b9587fd7a.png" width="694" height="668" class="img_ev3q"></p>
<p>After entering their credentials, they will be logged into Grafana as shown in the screenshot below.
<img decoding="async" loading="lazy" alt="AMG - Grafana user settings page" src="/observability-best-practices/assets/images/13-07b97c6f9b4ef62b9ef34819ab5429bb.png" width="867" height="984" class="img_ev3q"></p>
<p>As you can see, the user was able to successfully login to Grafana using Google Workspaces authentication.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/aws-observability/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml#create-amazon-managed-grafana-workspace">Create Amazon Managed Grafana workspace</a></li><li><a class="table-of-contents__link toc-highlight" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml#configure-google-workspaces">Configure Google Workspaces</a></li><li><a class="table-of-contents__link toc-highlight" href="/observability-best-practices/docs/recipes/recipes/amg-google-auth-saml#upload-saml-metadata-into-amazon-managed-grafana">Upload SAML metadata into Amazon Managed Grafana</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2024.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>