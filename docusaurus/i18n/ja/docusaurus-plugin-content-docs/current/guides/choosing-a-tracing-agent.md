# トレーシングエージェントの選択

## 適切なエージェントを選択する

AWS は、[トレース](../signals/traces/)収集のために 2 つのツールセットを直接サポートしています（さらに、豊富な[オブザーバビリティパートナー](https://aws.amazon.com/products/management-and-governance/partners/)もあります）。

* 一般的に ADOT と呼ばれる [AWS Distro for OpenTelemetry](https://aws-otel.github.io/)
* X-Ray の [SDK](https://docs.aws.amazon.com/xray/latest/devguide/xray-instrumenting-your-app.html) と [デーモン](https://docs.aws.amazon.com/xray/latest/devguide/xray-daemon.html)

どのツールまたはツールの組み合わせを使用するかの選択は、オブザーバビリティソリューションを進化させる際に行う必要がある主要な決定事項です。これらのツールは相互排他的ではなく、必要に応じて組み合わせることができます。そして、この選択を行うためのベストプラクティスがあります。ただし、まず [OpenTelemetry (OTEL)](https://opentelemetry.io/) の現状を理解する必要があります。

OTEL は、オブザーバビリティシグナリングの現在の業界標準仕様であり、3 つのコアシグナルタイプ（[メトリクス](../signals/metrics/)、[トレース](../signals/traces/)、[ログ](../signals/logs)）のそれぞれの定義が含まれています。ただし、OTEL は常に存在していたわけではなく、[OpenMetrics](https://openmetrics.io) や [OpenTracing](https://opentracing.io) などの以前の仕様から進化してきました。オブザーバビリティベンダーは、近年 OpenTelemetry Line Protocol (OTLP) のオープンサポートを開始しました。

AWS X-Ray と CloudWatch は、他の主要なオブザーバビリティソリューションと同様に、OTEL 仕様よりも前から存在しています。ただし、AWS X-Ray サービスは ADOT を使用して OTEL トレースを容易に受け入れることができます。ADOT には、X-Ray に直接テレメトリを送信するための統合機能がすでに組み込まれており、他の ISV ソリューションへの送信も可能です。

トランザクショントレーシングソリューションには、シグナルを収集するためのエージェントと基盤となるアプリケーションへの統合が必要です。これにより、テスト、メンテナンス、アップグレードが必要なライブラリという形で技術的負債が発生し、将来ソリューションを変更する場合には再構築が必要になる可能性もあります。

X-Ray に含まれる SDK は、AWS が提供する緊密に統合されたインストルメンテーションソリューションの一部です。ADOT は、X-Ray が多数のトレーシングソリューションの 1 つに過ぎない、より広範な業界ソリューションの一部です。どちらのアプローチを使用しても X-Ray でエンドツーエンドのトレーシングを実装できますが、最も有用なアプローチを決定するには、違いを理解することが重要です。

:::info
	次の場合は、AWS Distro for OpenTelemetry でアプリケーションをインストルメント化することをお勧めします。

* コードを再計装することなく、複数の異なるトレーシングバックエンドにトレースを送信できる機能。たとえば、X-Ray コンソールの使用から [Zipkin](https://zipkin.io) への移行を希望する場合、コレクターの設定のみを変更すればよく、アプリケーションコードはそのまま残ります。

* OpenTelemetry コミュニティによって保守されている、各言語の多数のライブラリインストルメンテーションをサポート。 
:::

:::info
	アプリケーションをインストルメント化するために X-Ray SDK を選択することをお勧めします。次の機能が必要な場合に適しています。

* 緊密に統合された単一ベンダーソリューション。

* X-Ray 集中サンプリングルールとの統合。Node.js、Python、Ruby、または .NET を使用する場合、X-Ray コンソールからサンプリングルールを設定し、複数のホスト間で自動的に使用する機能を含みます
:::