# なぜオブザーバビリティが必要なのか?

YouTube の [Developing an Observability Strategy](https://www.youtube.com/watch?v=Ub3ATriFapQ) をご覧ください。

## 本当に重要なことは何ですか?

職場で行うすべての作業は、組織のミッションに沿ったものでなければなりません。私たち従業員全員は、組織のミッションを果たし、その将来像に向けて働いています。Amazon のミッションは次のように述べられています。

> Amazon は、地球で最も顧客中心の企業、最高の雇用主、そして最も安全な職場になることを目指しています。

- [About Amazon](https://www.aboutamazon.com/about-us)

IT 分野では、すべてのプロジェクト、デプロイ、セキュリティ対策、最適化は、ビジネス成果につながるものでなければなりません。当然のことのように思えますが、ビジネスに価値を加えないことは何もすべきではありません。ITIL が述べているように、

> すべての変更はビジネス価値を生み出すべきです。

- ITIL Service Transition, AXELOS, 2011, page 44.
- [Change Management in the Cloud AWS ホワイトペーパー](https://docs.aws.amazon.com/ja_jp/whitepapers/latest/change-management-in-the-cloud/change-management-in-the-cloud.html)

ミッションとビジネス価値が重要なのは、それらがあなたの行動すべてに影響を与えるべきだからです。オブザーバビリティには多くの利点がありますが、その中には以下のようなものがあります。

- 可用性の向上
- 信頼性の向上
- アプリケーションの健全性とパフォーマンスの理解
- 協業の改善
- 問題の積極的な検出
- 顧客満足度の向上
- 市場投入期間の短縮
- 運用コストの削減
- 自動化

これらすべての利点に共通するのは、顧客に直接的か間接的かを問わず、ビジネス価値を生み出すということです。オブザーバビリティを考える際は、常にアプリケーションがビジネス価値を生み出しているかどうかを考える必要があります。

つまり、オブザーバビリティは、ビジネス価値の創出に寄与するものを測定し、ビジネス成果と、それが危機に瀕している状況に焦点を当てる必要があります。顧客が何を求め、何を必要としているかを考えなければなりません。

## どこから始めればよいですか?

重要なことがわかったので、次は何を測定する必要があるかを考えましょう。Amazon では、顧客から逆算して始めます。

> 私たちは、必要に迫られる前から、サービスの改善、新機能の追加、価値の向上に努めています。価格を下げ、顧客への価値を高める前から行動を起こします。必要に迫られる前から革新を行います。

— Jeff Bezos, [2012 年株主向け手紙](https://s2.q4cdn.com/299287126/files/doc_financials/annual/2012-Shareholder-Letter.pdf)

EC サイトを例に考えてみましょう。まず、オンラインで商品を購入する際に、顧客として何を求めるかを考えます。人によって異なりますが、おそらく次のようなことが重要でしょう。

- 配送
- 価格
- セキュリティ
- ページの読み込み速度
- 検索 (探している商品が見つけられるか?)

顧客が何を重視しているかがわかれば、それらを測定し、ビジネス成果にどのように影響するかを把握できます。ページの読み込み速度は、コンバージョン率や検索エンジンの順位に直接影響します。2017 年の調査では、モバイルユーザーの 53% 以上がページの読み込みに 3 秒以上かかると離脱することがわかっています。ページの読み込み速度の重要性を示す研究は多数ありますが、測定し、コンバージョンに測定可能な影響があるため、改善のためにそのデータを活用する必要があります。

## ワーキングバックワーズ

お客様が何を重視しているかを全て知っていることは期待できません。この文章を読んでいる方は、おそらく技術的な役割を担っています。組織内の利害関係者と話をする必要がありますが、これは簡単ではありませんが、重要なことを測定するために不可欠です。

EC サイトの例を続けましょう。今回は検索機能について考えてみましょう。お客様が商品を購入するためには検索できる必要があることは明らかですが、[Forrester Research レポート](https://www.forrester.com/report/MustHave+eCommerce+Features/-/E-RES89561)によると、訪問者の 43% が即座に検索ボックスに移動し、検索者の方が非検索者に比べて 2〜3 倍の確率で購入に至るそうです。検索機能は非常に重要で、うまく機能する必要があり、モニタリングする必要があります。特定の検索で結果が得られない場合は、単純なパターンマッチングから自然言語処理に移行する必要があるかもしれません。これは、ビジネス成果をモニタリングし、顧客体験を改善するための行動を起こす例です。

Amazon では:

> 私たちは顧客を深く理解し、彼らの痛みの種から逆算して、彼らの人生に意味のあるソリューションを迅速に開発することに努めています。

- Daniel Slater - Worldwide Lead, Culture of Innovation, AWS in [Elements of Amazon's Day 1 Culture](https://aws.amazon.com/jp/executive-insights/content/how-amazon-defines-and-operationalizes-a-day-1-culture/)

私たちは顧客から始め、そこから逆算して顧客のニーズを満たします。これはビジネスで成功する唯一の方法ではありませんが、オブザーバビリティにとって良い方法です。利害関係者と協力して、顧客にとって何が重要かを理解し、そこから逆算していきます。

付加的な利点として、顧客と利害関係者にとって重要なメトリクスを収集すれば、これらをリアルタイムに近いダッシュボードで可視化でき、「ランディングページの読み込みにどのくらい時間がかかっているか」や「Webサイトの運用にどのくらいコストがかかっているか」といった質問に答えたり、レポートを作成する必要がなくなります。利害関係者や経営陣がこの情報を自己サービスで取得できるようにすべきです。

これらは、アプリケーションにとって本当に重要な上位レベルのメトリクスであり、問題があることを示す最良の指標でもあります。例えば、通常よりも注文数が少ないことを示すアラートは、顧客に影響を与える問題があることを示しています。一方、サーバーのボリュームがほぼ一杯になっているというアラートや、特定のサービスで多数の 5xx エラーが発生しているというアラートは、修正が必要かもしれませんが、顧客への影響を理解し、優先順位を付ける必要があります。これには時間がかかる場合があります。

このような上位レベルのビジネスメトリクスを測定していれば、顧客に影響を与える問題を簡単に特定できます。これらのメトリクスは、「何が」起きているかを示します。その他のメトリクスやトレーシング、ログなどの他のオブザーバビリティ形式は、「なぜ」それが起きているのかを示し、問題を修正または改善するための手がかりとなります。

## 観察対象

お客様にとって重要なことがわかったので、次はキーパフォーマンス指標 (KPI) を特定できます。これらは、ビジネス成果が危険にさらされているかどうかを示す上位レベルのメトリクスです。また、それらの KPI に影響を与える可能性のある様々な情報源からデータを収集する必要があります。先ほど説明したように、5xx エラーの数自体は影響を示すものではありませんが、KPI に影響を与える可能性があります。ビジネス成果に影響を与えるものから、ビジネス成果に影響を与える可能性のあるものに遡って考えていく必要があります。

収集が必要なものがわかったら、KPI を測定するためのメトリクスと、それらの KPI に影響を与える可能性のあるメトリクスを提供する情報源を特定する必要があります。これが観察対象の基礎となります。

このデータは、メトリクス、ログ、トレースから得られる可能性が高いです。このデータを入手したら、成果が危険にさらされているときにアラートを出すことができます。

その後、影響を評価し、問題を解決しようと試みることができます。ほとんどの場合、このデータは、単一の技術的なメトリクス (CPU やメモリなど) よりも先に問題があることを示します。

観察データを使って、ビジネス成果に影響を与える問題を事後的に修正することも、お客様の検索体験を改善するなど、積極的に活用することもできます。

## 結論

CPU、RAM、ディスク容量などの技術的なメトリクスは、スケーリング、パフォーマンス、容量、コストの観点から重要ですが、アプリケーションの状況や顧客体験に関する洞察は得られません。

重要なのは顧客であり、監視すべきは顧客体験です。

そのため、顧客の要件から逆算し、ステークホルダーと協力して、重要な KPI とメトリクスを確立する必要があります。
