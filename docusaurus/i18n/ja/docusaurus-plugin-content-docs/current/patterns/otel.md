# OpenTelemetry によるオブザーバビリティ

OpenTelemetry は、ログ、メトリクス、トレースを含むテレメトリデータを収集およびエクスポートするための標準化された方法を提供する、オープンソースでベンダーニュートラルなオブザーバビリティフレームワークです。OpenTelemetry を活用することで、組織はベンダー独立性を確保し、オブザーバビリティ戦略を将来にわたって保証しながら、包括的なオブザーバビリティパイプラインを実装できます。

## OpenTelemetry によるメトリクスとインサイトの収集

1. **インストルメンテーション**: OpenTelemetry を使用する最初のステップは、OpenTelemetry ライブラリまたは SDK を使用してアプリケーションとサービスをインストルメント化することです。これらのライブラリは、アプリケーションコードからメトリクス、トレース、ログなどのテレメトリデータを自動的にキャプチャしてエクスポートします。

2. **メトリクスの収集**: OpenTelemetry は、アプリケーションからメトリクスを収集してエクスポートするための標準化された方法を提供します。これらのメトリクスには、システムメトリクス (CPU、メモリ、ディスク使用量)、アプリケーションレベルのメトリクス (リクエスト率、エラー率、レイテンシー)、およびアプリケーション固有のカスタムビジネスメトリクスを含めることができます。

3. **分散トレーシング**: OpenTelemetry は分散トレーシングをサポートしており、分散システム全体でリクエストとオペレーションが伝播する様子をトレースできます。これにより、リクエストのエンドツーエンドのフローに関する貴重な洞察が得られ、ボトルネックの特定やパフォーマンス問題のトラブルシューティングが可能になります。

4. **ログ記録**: OpenTelemetry の主な焦点はメトリクスとトレースですが、ログデータをキャプチャしてエクスポートするために使用できる構造化ログ記録 API も提供しています。これにより、ログが他のテレメトリデータと関連付けられ、システムの動作を包括的に把握できます。

5. **Exporters**: OpenTelemetry は、テレメトリデータをさまざまなバックエンドやオブザーバビリティプラットフォームに送信できる、多様なエクスポーターをサポートしています。一般的なエクスポーターには、Prometheus、Jaeger、Zipkin、および AWS CloudWatch、Azure Monitor、Google Cloud Operations などのクラウドネイティブなオブザーバビリティソリューションがあります。

6. **データ処理と分析**: テレメトリデータがエクスポートされると、オブザーバビリティプラットフォーム、モニタリングツール、またはカスタムデータ処理パイプラインを活用して、収集されたメトリクス、トレース、ログを分析および可視化できます。この分析により、システムパフォーマンスに関する洞察が得られ、ボトルネックを特定し、トラブルシューティングと根本原因分析を支援できます。
![Otel](./images/otel.png)
*図 1: ADOT と FluentBit を使用してオブザーバビリティシグナルを送信する EKS クラスター*
<!--Ref: https://aws.amazon.com/blogs/architecture/amazon-cloudwatch-insights-for-amazon-eks-on-ec2-using-aws-distro-for-opentelemetry-helm-charts/-->

## OpenTelemetry を使用する利点

1. **ベンダーニュートラル**: OpenTelemetry はオープンソースでベンダーニュートラルなプロジェクトであり、オブザーバビリティ戦略が特定のベンダーやプラットフォームに縛られないことを保証します。この柔軟性により、オブザーバビリティバックエンドを切り替えたり、必要に応じて複数のソリューションを組み合わせたりすることができます。

2. **標準化**: OpenTelemetry は、テレメトリデータを収集およびエクスポートする標準化された方法を提供し、異なるコンポーネントやシステム間で一貫したデータ形式と相互運用性を実現します。

3. **将来性**: OpenTelemetry を採用することで、オブザーバビリティ戦略を将来にわたって有効に保つことができます。プロジェクトが進化し、新しい機能や統合が追加されても、既存のインストルメンテーションは大幅なコード変更を必要とせず、簡単に更新できます。

4. **包括的なオブザーバビリティ**: OpenTelemetry は複数のテレメトリシグナル (メトリクス、トレース、ログ) をサポートし、システムの動作とパフォーマンスの包括的なビューを提供します。

5. **エコシステムとコミュニティサポート**: OpenTelemetry には、統合、ツール、活発な貢献者コミュニティからなる成長中のエコシステムがあり、継続的な開発とサポートが保証されています。

OpenTelemetry をオブザーバビリティに活用することで、組織はシステムに関する深い洞察を得ることができ、プロアクティブな監視、効率的なトラブルシューティング、データ駆動型の意思決定を可能にしながら、オブザーバビリティ戦略における柔軟性とベンダー独立性を維持できます。