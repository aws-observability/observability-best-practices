<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/containers/aws-native/eks/amazon-cloudwatch-container-insights" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Amazon CloudWatch Container Insights | AWS Observability Best Practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Amazon CloudWatch Container Insights | AWS Observability Best Practices"><meta data-rh="true" name="description" content="In this section of Observability best practices guide, we will deep dive on to following topics related to Amazon CloudWatch Container Insights :"><meta data-rh="true" property="og:description" content="In this section of Observability best practices guide, we will deep dive on to following topics related to Amazon CloudWatch Container Insights :"><link data-rh="true" rel="icon" href="/observability-best-practices/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/ja/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights" hreflang="ja"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Amazon CloudWatch Container Insights","item":"https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights"}]}</script><link rel="alternate" type="application/rss+xml" href="/observability-best-practices/blog/rss.xml" title="AWS Observability Best Practices RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/observability-best-practices/blog/atom.xml" title="AWS Observability Best Practices Atom Feed"><link rel="stylesheet" href="/observability-best-practices/assets/css/styles.c966ebab.css">
<script src="/observability-best-practices/assets/js/runtime~main.29d7cc2e.js" defer="defer"></script>
<script src="/observability-best-practices/assets/js/main.b2dcb233.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/observability-best-practices/"><div class="navbar__logo"><img src="/observability-best-practices/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/observability-best-practices/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AWS Observability Best Practices</b></a><a class="navbar__item navbar__link" href="/observability-best-practices/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/observability-best-practices/guides/">Guides</a><a class="navbar__item navbar__link" href="/observability-best-practices/signals/logs">Signals</a><a class="navbar__item navbar__link" href="/observability-best-practices/tools/observability_accelerator">Tools</a><a class="navbar__item navbar__link" href="/observability-best-practices/recipes/">Recipes</a><a class="navbar__item navbar__link" href="/observability-best-practices/faq/general">FAQ</a><a class="navbar__item navbar__link" href="/observability-best-practices/patterns/Tracing/xrayec2">Patterns</a><a class="navbar__item navbar__link" href="/observability-best-practices/persona/cloud_engineer">Persona</a><a class="navbar__item navbar__link" href="/observability-best-practices/resources/">Resources</a><a class="navbar__item navbar__link" href="/observability-best-practices/contributors">Contributors</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/observability-best-practices/ja/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><a href="https://github.com/aws-observability/observability-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/observability-best-practices/guides/"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/"><span title="Best practices overview" class="linkLabel_WmDU">Best practices overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/choosing-a-tracing-agent"><span title="Choosing a tracing agent" class="linkLabel_WmDU">Choosing a tracing agent</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/cost/kubecost"><span title="Cost" class="categoryLinkLabel_W154">Cost</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/databases/rds-and-aurora"><span title="Databases" class="categoryLinkLabel_W154">Databases</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/ec2-monitoring"><span title="EC2 Monitoring and Observability" class="linkLabel_WmDU">EC2 Monitoring and Observability</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/ecs/best-practices-metrics-collection-1"><span title="ECS best practices" class="categoryLinkLabel_W154">ECS best practices</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights"><span title="EKS best practices" class="categoryLinkLabel_W154">EKS best practices</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights"><span title="EKS AWS Native" class="categoryLinkLabel_W154">EKS AWS Native</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights"><span title="Amazon CloudWatch Container Insights" class="linkLabel_WmDU">Amazon CloudWatch Container Insights</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/eks/log-aggregation"><span title="Log Aggregation" class="linkLabel_WmDU">Log Aggregation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/eks/eks-api-server-monitoring"><span title="Amazon EKS API Server Monitoring" class="linkLabel_WmDU">Amazon EKS API Server Monitoring</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/containers/aws-native/eks/container-tracing-with-aws-xray"><span title="Container Tracing with AWS X-Ray" class="linkLabel_WmDU">Container Tracing with AWS X-Ray</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/containers/oss/eks/best-practices-metrics-collection"><span title="EKS Open Source" class="categoryLinkLabel_W154">EKS Open Source</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/dotnet/aws-native/logs"><span title=".NET" class="categoryLinkLabel_W154">.NET</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/serverless/aws-native/lambda-based-observability"><span title="Serverless best practices" class="categoryLinkLabel_W154">Serverless best practices</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/hybrid-and-multicloud"><span title="Best practices for hybrid and multicloud" class="linkLabel_WmDU">Best practices for hybrid and multicloud</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/operational/adot-at-scale/operating-adot-collector"><span title="Operational" class="categoryLinkLabel_W154">Operational</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/signal-collection/emf"><span title="Signal collection" class="categoryLinkLabel_W154">Signal collection</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/guides/partners/databricks"><span title="Partners" class="categoryLinkLabel_W154">Partners</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/observability-maturity-model"><span title="AWS Observability Maturity Model" class="linkLabel_WmDU">AWS Observability Maturity Model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/guides/cloudwatch_cross_account_observability"><span title="CloudWatch Cross-Account Observability" class="linkLabel_WmDU">CloudWatch Cross-Account Observability</span></a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/observability-best-practices/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">EKS best practices</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">EKS AWS Native</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Amazon CloudWatch Container Insights</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Amazon CloudWatch Container Insights</h1></header>
<p>In this section of Observability best practices guide, we will deep dive on to following topics related to Amazon CloudWatch Container Insights :</p>
<ul>
<li class="">Introduction to Amazon CloudWatch Container Insights</li>
<li class="">Using Amazon CloudWatch Container Insights with AWS Distro for Open Telemetry</li>
<li class="">Fluent Bit Integration in CloudWatch Container Insights for Amazon EKS</li>
<li class="">Cost savings with Container Insights on Amazon EKS</li>
<li class="">Using EKS Blueprints to setup Container Insights</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction" translate="no">​</a></h3>
<p><a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html" target="_blank" rel="noopener noreferrer" class="">Amazon CloudWatch Container Insights</a> helps customers collect, aggregate, and summarize metrics and logs from containerized applications and microservices. Metrics data is collected as performance log events using the <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Embedded_Metric_Format.html" target="_blank" rel="noopener noreferrer" class="">embedded metric format</a>. These performance log events use a structured JSON schema that enables high-cardinality data to be ingested and stored at scale. From this data, CloudWatch creates aggregated metrics at the cluster, node, pod, task, and service level as CloudWatch metrics. The metrics that Container Insights collects are available in CloudWatch automatic dashboards. Container Insights are available for Amazon EKS clusters with self managed node groups, managed node groups and AWS Fargate profiles.</p>
<p>From a cost optimization standpoint and to help you manage your Container Insights cost, CloudWatch does not automatically create all possible metrics from the log data. However, you can view additional metrics and additional levels of granularity by using CloudWatch Logs Insights to analyze the raw performance log events. Metrics collected by Container Insights are charged as custom metrics. For more information about CloudWatch pricing, see <a href="https://aws.amazon.com/cloudwatch/pricing/" target="_blank" rel="noopener noreferrer" class="">Amazon CloudWatch Pricing</a>.</p>
<p>In Amazon EKS, Container Insights uses a containerized version of the <a href="https://gallery.ecr.aws/cloudwatch-agent/cloudwatch-agent" target="_blank" rel="noopener noreferrer" class="">CloudWatch agent</a> which is provided by Amazon via Amazon Elastic Container Registry to discover all of the running containers in a cluster. It then collects performance data at every tier of the performance stack. Container Insights supports encryption with the AWS KMS key for the logs and metrics that it collects. To enable this encryption, you must manually enable AWS KMS encryption for the log group that receives Container Insights data. This results in CloudWatch Container Insights encrypting this data using the provided AWS KMS key. Only symmetric keys are supported and asymmetric AWS KMS keys are not supported to encrypt your log groups. Container Insights are supported only in Linux instances. Container Insights for Amazon EKS is supported in the <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html#:~:text=Container%20Insights%20for%20Amazon%20EKS%20and%20Kubernetes%20is%20supported%20in%20the%20following%20Regions%3A" target="_blank" rel="noopener noreferrer" class="">these</a> AWS Regions.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-amazon-cloudwatch-container-insights--with-aws-distro-for-open-telemetry">Using Amazon CloudWatch Container Insights  with AWS Distro for Open Telemetry<a href="#using-amazon-cloudwatch-container-insights--with-aws-distro-for-open-telemetry" class="hash-link" aria-label="Direct link to Using Amazon CloudWatch Container Insights  with AWS Distro for Open Telemetry" title="Direct link to Using Amazon CloudWatch Container Insights  with AWS Distro for Open Telemetry" translate="no">​</a></h3>
<p>We will now deep dive in to <a href="https://aws-otel.github.io/docs/introduction" target="_blank" rel="noopener noreferrer" class="">AWS Distro for OpenTelemetry (ADOT)</a> which is one of the options to enable collection of Container insight metrics from Amazon EKS workloads. <a href="https://aws-otel.github.io/docs/introduction" target="_blank" rel="noopener noreferrer" class="">AWS Distro for OpenTelemetry (ADOT)</a> is a secure, AWS-supported distribution of the <a href="https://opentelemetry.io/docs/" target="_blank" rel="noopener noreferrer" class="">OpenTelemetry</a> project. With ADOT, users can instrument their applications just once to send correlated metrics and traces to multiple monitoring solutions. With ADOT support for CloudWatch Container Insights, customers can collect system metrics such as CPU, memory, disk, and network usage from Amazon EKS clusters running on <a href="https://aws.amazon.com/pm/ec2/?trk=ps_a134p000004f2ZFAAY&amp;trkCampaign=acq_paid_search_brand&amp;sc_channel=PS&amp;sc_campaign=acquisition_US&amp;sc_publisher=Google&amp;sc_category=Cloud%20Computing&amp;sc_country=US&amp;sc_geo=NAMER&amp;sc_outcome=acq&amp;sc_detail=amazon%20ec2&amp;sc_content=EC2_e&amp;sc_matchtype=e&amp;sc_segment=467723097970&amp;sc_medium=ACQ-P%7CPS-GO%7CBrand%7CDesktop%7CSU%7CCloud%20Computing%7CEC2%7CUS%7CEN%7CText&amp;s_kwcid=AL!4422!3!467723097970!e!!g!!amazon%20ec2&amp;ef_id=Cj0KCQiArt6PBhCoARIsAMF5waj-FXPUD0G-cm0dJ05Mz6aXDvqEGu-S7pCXwvVusULN6ZbPbc_Alg8aArOHEALw_wcB:G:s&amp;s_kwcid=AL!4422!3!467723097970!e!!g!!amazon%20ec2" target="_blank" rel="noopener noreferrer" class="">Amazon Elastic Cloud Compute</a> (Amazon EC2), providing the same experience as Amazon CloudWatch agent. ADOT Collector is now available with support for CloudWatch Container Insights for Amazon EKS and AWS Fargate profile for Amazon EKS. Customers can now collect container and pod metrics such as CPU and memory utilization for their pods that are deployed to an Amazon EKS cluster and view them in CloudWatch dashboards without any changes to their existing CloudWatch Container Insights experience. This will enable customers to also determine whether to scale up or down to respond to traffic and save costs.</p>
<p>The ADOT Collector has the <a href="https://opentelemetry.io/docs/collector/configuration/" target="_blank" rel="noopener noreferrer" class="">concept of a pipeline</a> which comprises three key types of components, namely, receiver, processor, and exporter. A <a href="https://opentelemetry.io/docs/collector/configuration/#receivers" target="_blank" rel="noopener noreferrer" class="">receiver</a> is how data gets into the collector. It accepts data in a specified format, translates it into the internal format and passes it to <a href="https://opentelemetry.io/docs/collector/configuration/#processors" target="_blank" rel="noopener noreferrer" class="">processors</a> and <a href="https://opentelemetry.io/docs/collector/configuration/#exporters" target="_blank" rel="noopener noreferrer" class="">exporters</a> defined in the pipeline. It can be pull or push based. A processor is an optional component that is used to perform tasks such as batching, filtering, and transformations on data between being received and being exported. An exporter is used to determine which destination to send the metrics, logs or traces. The collector architecture allows multiple instances of such pipelines to be defined via YAML configuration. The following diagrams illustrates the pipeline components in an ADOT Collector instance deployed to Amazon EKS and Amazon EKS with Fargate profile.</p>
<p><img decoding="async" loading="lazy" alt="CW-ADOT-EKS" src="/observability-best-practices/assets/images/cw-adot-collector-pipeline-eks-a57495e3ee941a7dc20d9239727c5e9e.jpg" width="1648" height="1096" class="img_ev3q"></p>
<p><em>Figure: Pipeline components in an ADOT Collector instance deployed to Amazon EKS</em></p>
<p>In the above architecture, we are deploying we are using an instance of <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awscontainerinsightreceiver" target="_blank" rel="noopener noreferrer" class="">AWS Container Insights Receiver</a> in the pipeline and collect the metrics directly from the Kubelet. AWS Container Insights Receiver (<code>awscontainerinsightreceiver</code>) is an AWS specific receiver that supports <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html" target="_blank" rel="noopener noreferrer" class="">CloudWatch Container Insights</a>. CloudWatch Container Insights collect, aggregate, and summarize metrics and logs from your containerized applications and microservices. Data are collected as as performance log events using <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Embedded_Metric_Format.html" target="_blank" rel="noopener noreferrer" class="">embedded metric format</a>. From the EMF data, Amazon CloudWatch can create the aggregated CloudWatch metrics at the cluster, node, pod, task, and service level. Below is an example of a sample <code>awscontainerinsightreceiver</code> configuration :</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">receivers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  awscontainerinsightreceiver:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # all parameters are optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    collection_interval: 60s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container_orchestrator: eks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    add_service_as_attribute: true </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prefer_full_pod_name: false </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    add_full_pod_name_metric_label: false </span><br></span></code></pre></div></div>
<p>This entails deploying the collector as a DaemonSet using the above configuration on Amazon EKS. You will also have access to a fuller set of metrics collected by this receiver directly from the Kubelet. Having more than one instances of ADOT Collector will suffice to collect resource metrics from all the nodes in a cluster. Having a single instance of ADOT collector can be overwhelming during higher loads so always recommend to deploy more than one collector.</p>
<p><img decoding="async" loading="lazy" alt="CW-ADOT-FARGATE" src="/observability-best-practices/assets/images/cw-adot-collector-pipeline-7ac4d843c5bd5c85f737b1a86e546950.jpg" width="2280" height="1430" class="img_ev3q"></p>
<p><em>Figure: Pipeline components in an ADOT Collector instance deployed to Amazon EKS with Fargate profile</em></p>
<p>In the above architecture, the kubelet on a worker node in a Kubernetes cluster exposes resource metrics such as CPU, memory, disk, and network usage at the <em>/metrics/cadvisor</em> endpoint. However, in EKS Fargate networking architecture, a pod is not allowed to directly reach the kubelet on that worker node. Hence, the ADOT Collector calls the Kubernetes API Server to proxy the connection to the kubelet on a worker node, and collect kubelet’s cAdvisor metrics for workloads on that node. These metrics are made available in Prometheus format. Therefore, the collector uses an instance of <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/prometheusreceiver" target="_blank" rel="noopener noreferrer" class="">Prometheus Receiver</a> as a drop-in replacement for a Prometheus server and scrapes these metrics from the Kubernetes API server endpoint. Using Kubernetes service discovery, the receiver can discover all the worker nodes in an EKS cluster. Hence, more than one instances of ADOT Collector will suffice to collect resource metrics from all the nodes in a cluster. Having a single instance of ADOT collector can be overwhelming during higher loads so always recommend to deploy more than one collector.</p>
<p>The metrics then go through a series of processors that perform filtering, renaming, data aggregation and conversion, and so on. The following is the list of processors used in the pipeline of an ADOT Collector instance for Amazon EKS illustrated above.</p>
<ul>
<li class=""><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/filterprocessor" target="_blank" rel="noopener noreferrer" class="">Filter Processor</a> is part of the AWS OpenTelemetry distribution to include or exclude metrics based on their name. It can be used as part of the metrics collection pipeline to filter out unwanted metrics. For example, suppose that you want Container Insights to only collect pod-level metrics (with name prefix <code>pod_</code>) excluding those for networking, with name prefix <code>pod_network</code>.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      # filter out only renamed metrics which we care about</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          include:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            match_type: regexp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            metric_names:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              - new_container_.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              - pod_.*</span><br></span></code></pre></div></div>
<ul>
<li class=""><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/metricstransformprocessor" target="_blank" rel="noopener noreferrer" class="">Metrics Transform Processor</a> can be used to rename metrics, and add, rename or delete label keys and values. It can also be used to perform scaling and aggregations on metrics across labels or label values.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     metricstransform/rename:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        transforms:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - include: container_spec_cpu_quota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new_name: new_container_cpu_limit_raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            action: insert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            match_type: regexp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            experimental_match_labels: {&quot;container&quot;: &quot;\\S&quot;}</span><br></span></code></pre></div></div>
<ul>
<li class=""><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/cumulativetodeltaprocessor" target="_blank" rel="noopener noreferrer" class="">Cumulative to Delta Processor</a> converts monotonic, cumulative sum and histogram metrics to monotonic, delta metrics. Non-monotonic sums and exponential histograms are excluded.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">` # convert cumulative sum datapoints to delta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> cumulativetodelta:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - pod_cpu_usage_seconds_total </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - pod_network_rx_errors`</span><br></span></code></pre></div></div>
<ul>
<li class=""><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/deltatorateprocessor" target="_blank" rel="noopener noreferrer" class="">Delta to Rate Processor</a> to convert delta sum metrics to rate metrics. This rate is a gauge.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">` # convert delta to rate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deltatorate:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_memory_hierarchical_pgfault </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_memory_hierarchical_pgmajfault </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_network_rx_bytes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_network_rx_dropped </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_network_rx_errors </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_network_tx_errors </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - pod_network_tx_packets </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - new_container_memory_pgfault </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - new_container_memory_pgmajfault </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - new_container_memory_hierarchical_pgfault </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - new_container_memory_hierarchical_pgmajfault`</span><br></span></code></pre></div></div>
<ul>
<li class=""><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/metricsgenerationprocessor" target="_blank" rel="noopener noreferrer" class="">Metrics Generation Processor</a> can be used to create new metrics using existing metrics following a given rule.</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      experimental_metricsgeneration/1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - name: pod_memory_utilization_over_pod_limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            unit: Percent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            type: calculate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            metric1: pod_memory_working_set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            metric2: pod_memory_limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            operation: percent</span><br></span></code></pre></div></div>
<p>The final component in the pipeline is <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/exporter/awsemfexporter" target="_blank" rel="noopener noreferrer" class="">AWS CloudWatch EMF Exporter</a>, which converts the metrics to embedded metric format (EMF) and then sends them directly to CloudWatch Logs using the <a href="https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_PutLogEvents.html" target="_blank" rel="noopener noreferrer" class="">PutLogEvents</a> API. The following list of metrics is sent to CloudWatch by the ADOT Collector for each of the workloads running on Amazon EKS.</p>
<ul>
<li class="">pod_cpu_utilization_over_pod_limit</li>
<li class="">pod_cpu_usage_total</li>
<li class="">pod_cpu_limit</li>
<li class="">pod_memory_utilization_over_pod_limit</li>
<li class="">pod_memory_working_set</li>
<li class="">pod_memory_limit</li>
<li class="">pod_network_rx_bytes</li>
<li class="">pod_network_tx_bytes</li>
</ul>
<p>Each metric will be associated with the following dimension sets and collected under the CloudWatch namespace named <em>ContainerInsights</em>.</p>
<ul>
<li class="">ClusterName, LaunchType</li>
<li class="">ClusterName, Namespace, LaunchType</li>
<li class="">ClusterName, Namespace, PodName, LaunchType</li>
</ul>
<p>Further, Please learn about <a href="https://aws.amazon.com/blogs/containers/introducing-cloudwatch-container-insights-prometheus-support-with-aws-distro-for-opentelemetry-on-amazon-ecs-and-amazon-eks/" target="_blank" rel="noopener noreferrer" class="">Container Insights Prometheus support for ADOT</a> and <a href="https://aws.amazon.com/blogs/containers/introducing-amazon-cloudwatch-container-insights-for-amazon-eks-fargate-using-aws-distro-for-opentelemetry/" target="_blank" rel="noopener noreferrer" class="">deploying ADOT collector on Amazon EKS to visualize Amazon EKS resource metrics using CloudWatch Container Insights</a> to setup ADOT collector pipeline in your Amazon EKS cluster and how to visualize your Amazon EKS resource metrics in CloudWatch Container Insights. Additionally, please reference <a href="https://community.aws/tutorials/navigating-amazon-eks/eks-monitor-containerized-applications#step-3-use-cloudwatch-logs-insights-query-to-search-and-analyze-container-logs" target="_blank" rel="noopener noreferrer" class="">Easily Monitor Containerized Applications with Amazon CloudWatch Container Insights</a>, which includes step-by-step instructions on configuring an Amazon EKS cluster, deploying a containerized application, and monitoring the application&#x27;s performance using Container Insights.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="fluent-bit-integration-in-cloudwatch-container-insights-for-amazon-eks">Fluent Bit Integration in CloudWatch Container Insights for Amazon EKS<a href="#fluent-bit-integration-in-cloudwatch-container-insights-for-amazon-eks" class="hash-link" aria-label="Direct link to Fluent Bit Integration in CloudWatch Container Insights for Amazon EKS" title="Direct link to Fluent Bit Integration in CloudWatch Container Insights for Amazon EKS" translate="no">​</a></h3>
<p><a href="https://fluentbit.io/" target="_blank" rel="noopener noreferrer" class="">Fluent Bit</a> is an open source and multi-platform log processor and forwarder that allows you to collect data and logs from different sources, and unify and send them to different destinations including CloudWatch Logs. It’s also fully compatible with <a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer" class="">Docker</a> and <a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer" class="">Kubernetes</a> environments. Using the newly launched Fluent Bit daemonset, you can send container logs from your EKS clusters to CloudWatch logs for logs storage and analytics.</p>
<p>Due to its lightweight nature, using Fluent Bit as the default log forwarder in Container Insights on EKS worker nodes will allow you to stream application logs into CloudWatch logs efficiently and reliably. With Fluent Bit, Container Insights is able to deliver thousands of business critical logs at scale in a resource efficient manner, especially in terms of CPU and memory utilization at the pod level. In other words, compared to FluentD, which was the log forwarder used prior, Fluent Bit has a smaller resource footprint and, as a result, is more resource efficient for memory and CPU. On the other hand, <a href="https://github.com/aws/aws-for-fluent-bit" target="_blank" rel="noopener noreferrer" class="">AWS for Fluent Bit image</a>, which includes Fluent Bit and related plugins, gives Fluent Bit an additional flexibility of adopting new AWS features faster as the image aims to provide a unified experience within AWS ecosystem.</p>
<p>The architecture below shows individual components used by CloudWatch Container Insights for EKS:</p>
<p><img decoding="async" loading="lazy" alt="CW-COMPONENTS" src="/observability-best-practices/assets/images/cw-components-0a6886b7b1f1c933135cc484fe01f3b9.jpg" width="751" height="570" class="img_ev3q"></p>
<p><em>Figure: Individual components used by CloudWatch Container Insights for EKS.</em></p>
<p>While working with containers, it is recommended to push all the logs, including application logs, through the standard output (stdout) and standard error output (stderr) methods whenever possible using the Docker JSON logging driver. For this reason, in EKS, the logging driver is configured by default and everything that a containerized application writes to <code>stdout</code> or <code>stderr</code> is streamed into a JSON file under <code>“/var/log/containers&quot;</code> on the worker node. Container Insights classifies those logs into three different categories by default and creates dedicated input streams for each category within Fluent Bit and independent log groups within CloudWatch Logs. Those categories are:</p>
<ul>
<li class="">Application logs: All applications logs stored under <code>“/var/log/containers/*.log&quot;</code> are streamed into the dedicated <code>/aws/containerinsights/Cluster_Name/application</code> log group. All non-application logs such as kube-proxy and aws-node logs are excluded by default. However, additional Kubernetes add-on logs, such as CoreDNS logs, are also processed and streamed into this log group.</li>
<li class="">Host logs: system logs for each EKS worker node are streamed into the <code>/aws/containerinsights/Cluster_Name/host</code> log group. These system logs include the contents of <code>“/var/log/messages,/var/log/dmesg,/var/log/secure”</code> files. Considering the stateless and dynamic nature of containerized workloads, where EKS worker nodes are often being terminated during scaling activities, streaming those logs in real time with Fluent Bit and having those logs available in CloudWatch logs, even after the node is terminated, are critical in terms of observability and monitoring health of EKS worker nodes. It also enables you to debug or troubleshoot cluster issues without logging into worker nodes in many cases and analyze these logs in more systematic way.</li>
<li class="">Data plane logs: EKS already provides <a href="https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html" target="_blank" rel="noopener noreferrer" class="">control plane logs</a>. With Fluent Bit integration in Container Insights, the logs generated by EKS data plane components, which run on every worker node and are responsible for maintaining running pods are captured as data plane logs. These logs are also streamed into a dedicated CloudWatch log group under <code>‘ /aws/containerinsights/Cluster_Name/dataplane</code>. kube-proxy, aws-node, and Docker runtime logs are saved into this log group. In addition to control plane logs, having data plane logs stored in CloudWatch Logs helps to provide a complete picture of your EKS clusters.</li>
</ul>
<p>Further, Please learn more on topics such as Fluent Bit Configurations, Fluent Bit Monitoring and Log analysis from <a href="https://aws.amazon.com/blogs/containers/fluent-bit-integration-in-cloudwatch-container-insights-for-eks/" target="_blank" rel="noopener noreferrer" class="">Fluent Bit Integration with Amazon EKS</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cost-savings-with-container-insights-on-amazon-eks">Cost savings with Container Insights on Amazon EKS<a href="#cost-savings-with-container-insights-on-amazon-eks" class="hash-link" aria-label="Direct link to Cost savings with Container Insights on Amazon EKS" title="Direct link to Cost savings with Container Insights on Amazon EKS" translate="no">​</a></h3>
<p>With the default configuration, the Container Insights receiver collects the complete set of metrics as defined by the <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awscontainerinsightreceiver#available-metrics-and-resource-attributes" target="_blank" rel="noopener noreferrer" class="">receiver documentation</a>. The number of metrics and dimensions collected is high, and for large clusters this will significantly increase the costs for metric ingestion and storage. We are going to demonstrate two different approaches that you can use to configure the ADOT Collector to send only metrics that bring value and saves cost.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-processors">Using processors<a href="#using-processors" class="hash-link" aria-label="Direct link to Using processors" title="Direct link to Using processors" translate="no">​</a></h4>
<p>This approach involves the introduction of OpenTelemetry processors as discussed above to filter out metrics or attributes to reduce the size of <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Embedded_Metric_Format.html" target="_blank" rel="noopener noreferrer" class="">EMF logs</a>. We will demonstrate the basic usage of two processors namely <em>Filter</em> and <em>Resource.</em></p>
<p><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/filterprocessor/README.md" target="_blank" rel="noopener noreferrer" class="">Filter processors</a> can be included in the <code>ConfigMap</code> named <code>otel-agent-conf</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">processors:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # filter processors example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter/include:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # any names NOT matching filters are excluded from remainder of pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      include:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match_type: regexp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metric_names:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # re2 regexp patterns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - ^pod_.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter/exclude:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # any names matching filters are excluded from remainder of pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      exclude:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match_type: regexp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metric_names:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - ^pod_network.*</span><br></span></code></pre></div></div>
<p><a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourceprocessor/README.md" target="_blank" rel="noopener noreferrer" class="">Resource processor</a> is also built into the AWS OpenTelemetry Distro and can be used to remove unwanted metric attributes. For example, if you want to remove the <code>Kubernetes</code> and <code>Sources</code> fields from the EMF logs, you can add the resource processor to the pipeline:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  # resource processors example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resource:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attributes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - key: Sources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      action: delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - key: kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      action: delete</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="customize-metrics-and-dimensions">Customize Metrics and Dimensions<a href="#customize-metrics-and-dimensions" class="hash-link" aria-label="Direct link to Customize Metrics and Dimensions" title="Direct link to Customize Metrics and Dimensions" translate="no">​</a></h4>
<p>In this approach, you will configure the CloudWatch EMF exporter to generate only the set of metrics that you want to send to CloudWatch Logs. The <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/5ccdbe08c6a2a43b7c6c7f9c0031a4b0348394a9/exporter/awsemfexporter/README.md#metric_declaration" target="_blank" rel="noopener noreferrer" class="">metric_declaration</a> section of CloudWatch EMF exporter configuration can be used to define the set of metrics and dimensions that you want to export. For example, you can keep only pod metrics from the default configuration. This <code>metric_declaration</code> section will look like the following and to reduce the number of metrics, you can keep the dimension set only <code>[PodName, Namespace, ClusterName]</code> if you do not care about others:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  awsemf:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: ContainerInsights</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_group_name: &#x27;/aws/containerinsights/{ClusterName}/performance&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_stream_name: &#x27;{NodeName}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resource_to_telemetry_conversion:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dimension_rollup_option: NoDimensionRollup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parse_json_encoded_attr_values: [Sources, kubernetes]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Customized metric declaration section</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metric_declarations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # pod metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - dimensions: [[PodName, Namespace, ClusterName]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metric_name_selectors:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - pod_cpu_utilization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - pod_memory_utilization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - pod_cpu_utilization_over_pod_limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - pod_memory_utilization_over_pod_limit</span><br></span></code></pre></div></div>
<p>This configuration will produce and stream the following four metrics within single dimension <code>[PodName, Namespace, ClusterName]</code> rather than 55 different metrics for multiple dimensions in the default configuration:</p>
<ul>
<li class="">pod_cpu_utilization</li>
<li class="">pod_memory_utilization</li>
<li class="">pod_cpu_utilization_over_pod_limit</li>
<li class="">pod_memory_utilization_over_pod_limit</li>
</ul>
<p>With this configuration, you will only send the metrics that you are interested in rather than all the metrics configured by default. As a result, you will be able to decrease metric ingestion cost for Container Insights considerably. Having this flexibility will provide Container Insights costumers with high level of control over metrics being exported. Customizing metrics by modifying the <code>awsemf</code> exporter configuration is also highly flexible, and you can customize both the metrics that you want to send and their dimensions. Note that this is only applicable to logs that are sent to CloudWatch.</p>
<p>The two approaches demonstrated discussed above are not mutually exclusive with each other. In fact, they both can be combined for a high degree of flexibility in customizing metrics that we want ingested into our monitoring system. We use this approach to decrease costs associated with metric storage and processing, as show in following graph.</p>
<p><img decoding="async" loading="lazy" alt="CW-COST-EXPLORER" src="/observability-best-practices/assets/images/cw-cost-explorer-36744006c7f0596712be861fc21076e2.jpg" width="1441" height="579" class="img_ev3q"></p>
<p><em>Figure: AWS Cost Explorer</em></p>
<p>In the preceding AWS Cost Explorer graph, we can see daily cost associated with CloudWatch using different configurations on the ADOT Collector in a small EKS cluster (20 Worker nodes, 220 pods). <em>Aug 15th</em> shows CloudWatch bill using ADOT Collector with the default configuration. On <em>Aug 16th</em>, we have used the <a href="https://aws.amazon.com/blogs/containers/cost-savings-by-customizing-metrics-sent-by-container-insights-in-amazon-eks/#customize-emf-exporter" target="_blank" rel="noopener noreferrer" class="">Customize EMF exporter</a> approach and can see about 30% cost savings. On <em>Aug 17th</em>, we used the <a href="https://aws.amazon.com/blogs/containers/cost-savings-by-customizing-metrics-sent-by-container-insights-in-amazon-eks/#processors" target="_blank" rel="noopener noreferrer" class="">Processors</a> approach, which achieves about 45% costs saving.
You must consider the trade-offs of customizing metrics sent by Container Insights as you will be able to decrease monitoring costs by sacrificing visibility of the monitored cluster. But also, the built-in dashboard provided by Container Insights within the AWS Console can be impacted by customized metrics as you can select not sending metrics and dimensions used by the dashboard. For further learning please check on <a href="https://aws.amazon.com/blogs/containers/cost-savings-by-customizing-metrics-sent-by-container-insights-in-amazon-eks/" target="_blank" rel="noopener noreferrer" class="">Cost savings by customizing metrics sent by Container Insights in Amazon EKS</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-eks-blueprints-to-setup-container-insights">Using EKS Blueprints to setup Container Insights<a href="#using-eks-blueprints-to-setup-container-insights" class="hash-link" aria-label="Direct link to Using EKS Blueprints to setup Container Insights" title="Direct link to Using EKS Blueprints to setup Container Insights" translate="no">​</a></h3>
<p><a href="https://aws.amazon.com/blogs/containers/bootstrapping-clusters-with-eks-blueprints/" target="_blank" rel="noopener noreferrer" class="">EKS Blueprints</a> is a collection of Infrastructure as Code (IaC) modules that will help you configure and deploy consistent, batteries-included EKS clusters across accounts and regions. You can use EKS Blueprints to easily bootstrap an EKS cluster with <a href="https://docs.aws.amazon.com/eks/latest/userguide/eks-add-ons.html" target="_blank" rel="noopener noreferrer" class="">Amazon EKS add-ons</a> as well as a wide range of popular open-source add-ons, including Prometheus, Karpenter, Nginx, Traefik, AWS Load Balancer Controller, Container Insights, Fluent Bit, Keda, Argo CD, and more. EKS Blueprints is implemented in two popular IaC frameworks, <a href="https://github.com/aws-ia/terraform-aws-eks-blueprints" target="_blank" rel="noopener noreferrer" class="">HashiCorp Terraform</a> and <a href="https://github.com/aws-quickstart/cdk-eks-blueprints" target="_blank" rel="noopener noreferrer" class="">AWS Cloud Development Kit (AWS CDK)</a>, which help you automate infrastructure deployments.</p>
<p>As part of your Amazon EKS Cluster creation process using EKS Blueprints, you can setup Container Container Insights as a Day 2 operational tooling to collect, aggregate, and summarize metrics and logs from containerized applications and micro-services to Amazon CloudWatch console.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h3>
<p>In this section of Observability best practices guide, we covered lot of deeper details around CloudWatch Container insights which included a introduction to Amazon CloudWatch Container Insights and how it can help you to observe your containerized workloads on Amazon EKS. We covered deeper grounds on using Amazon CloudWatch Container Insights  with AWS Distro for Open Telemetry to enable collection fo Container insight metrics to visualize the metrics our your containerzied workloads on Amazon CloudWatch console. Next, we covered lot of depth around Fluent Bit Integration in CloudWatch Container Insights for Amazon EKS to create dedicated input streams within Fluent Bit and independent log groups within CloudWatch Logs for Application, Host and Data Plane logs. Next, we talked about two different approaches such as processors, metrics dimensions to achieve cost savings with CloudWatch Container insights. Finally we talked in brief about how use EKS Blueprints as a vehicle to setup Container Insights during the Amazon EKS cluster creation process. You can get hands-on experience with the <a href="https://catalog.workshops.aws/observability/en-US/aws-native/insights/containerinsights" target="_blank" rel="noopener noreferrer" class="">CloudWatch Container Insights module</a> with in the<a href="https://catalog.workshops.aws/observability/en-US" target="_blank" rel="noopener noreferrer" class="">One Observability Workshop</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/aws-observability/observability-best-practices/blob/main/docusaurus/docs/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/observability-best-practices/guides/containers/oss/ecs/best-practices-metrics-collection-2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Collecting service metrics in an ECS cluster using AWS Distro for OpenTelemetry</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/observability-best-practices/guides/containers/aws-native/eks/log-aggregation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Log Aggregation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#using-amazon-cloudwatch-container-insights--with-aws-distro-for-open-telemetry" class="table-of-contents__link toc-highlight">Using Amazon CloudWatch Container Insights  with AWS Distro for Open Telemetry</a></li><li><a href="#fluent-bit-integration-in-cloudwatch-container-insights-for-amazon-eks" class="table-of-contents__link toc-highlight">Fluent Bit Integration in CloudWatch Container Insights for Amazon EKS</a></li><li><a href="#cost-savings-with-container-insights-on-amazon-eks" class="table-of-contents__link toc-highlight">Cost savings with Container Insights on Amazon EKS</a></li><li><a href="#using-eks-blueprints-to-setup-container-insights" class="table-of-contents__link toc-highlight">Using EKS Blueprints to setup Container Insights</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2026.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>