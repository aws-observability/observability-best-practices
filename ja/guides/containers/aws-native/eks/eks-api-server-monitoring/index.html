<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/containers/aws-native/eks/eks-api-server-monitoring" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Amazon EKS API サーバーのモニタリング | AWS Observability Best Practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-observability.github.io/observability-best-practices/ja/guides/containers/aws-native/eks/eks-api-server-monitoring"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Amazon EKS API サーバーのモニタリング | AWS Observability Best Practices"><meta data-rh="true" name="description" content="オブザーバビリティのベストプラクティスガイドのこのセクションでは、API サーバーのモニタリングに関連する以下のトピックについて詳しく説明します："><meta data-rh="true" property="og:description" content="オブザーバビリティのベストプラクティスガイドのこのセクションでは、API サーバーのモニタリングに関連する以下のトピックについて詳しく説明します："><link data-rh="true" rel="icon" href="/observability-best-practices/ja/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-observability.github.io/observability-best-practices/ja/guides/containers/aws-native/eks/eks-api-server-monitoring"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/eks-api-server-monitoring" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/ja/guides/containers/aws-native/eks/eks-api-server-monitoring" hreflang="ja"><link data-rh="true" rel="alternate" href="https://aws-observability.github.io/observability-best-practices/guides/containers/aws-native/eks/eks-api-server-monitoring" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/observability-best-practices/ja/blog/rss.xml" title="AWS Observability Best Practices RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/observability-best-practices/ja/blog/atom.xml" title="AWS Observability Best Practices Atom Feed"><link rel="stylesheet" href="/observability-best-practices/ja/assets/css/styles.e835fd1b.css">
<script src="/observability-best-practices/ja/assets/js/runtime~main.d48eceaf.js" defer="defer"></script>
<script src="/observability-best-practices/ja/assets/js/main.da851f34.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/observability-best-practices/ja/"><div class="navbar__logo"><img src="/observability-best-practices/ja/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/observability-best-practices/ja/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AWS Observability Best Practices</b></a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/observability-best-practices/ja/guides/">Guides</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/signals/logs">Signals</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/tools/observability_accelerator">Tools</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/recipes/">Recipes</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/faq/general">FAQ</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/patterns/Tracing/xrayec2">Patterns</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/persona/cloud_engineer">Persona</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/resources/">Resources</a><a class="navbar__item navbar__link" href="/observability-best-practices/ja/contributors">Contributors</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/observability-best-practices/guides/containers/aws-native/eks/eks-api-server-monitoring" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/observability-best-practices/ja/guides/containers/aws-native/eks/eks-api-server-monitoring" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li></ul></div><a href="https://github.com/aws-observability/observability-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/observability-best-practices/ja/guides/">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/">ベストプラクティスの概要</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/choosing-a-tracing-agent">トレーシングエージェントの選択</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/cost/kubecost">Cost</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/databases/rds-and-aurora">Databases</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/ec2-monitoring">EC2 のモニタリングとオブザーバビリティ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/ecs/best-practices-metrics-collection-1">ECS best practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights">EKS best practices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights">AWS Native</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/eks/amazon-cloudwatch-container-insights">Amazon CloudWatch Container Insights</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/eks/log-aggregation">ログ集約</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/eks/eks-api-server-monitoring">Amazon EKS API サーバーのモニタリング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/containers/aws-native/eks/container-tracing-with-aws-xray">AWS X-Ray によるコンテナトレーシング</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/containers/oss/eks/best-practices-metrics-collection">Open Source</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/serverless/aws-native/lambda-based-observability">Serverless best practices</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/hybrid-and-multicloud">ハイブリッドおよびマルチクラウドのベストプラクティス</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/operational/adot-at-scale/operating-adot-collector">Operational</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/signal-collection/emf">Signal collection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/observability-best-practices/ja/guides/partners/databricks">Partners</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/observability-maturity-model">AWS オブザーバビリティ成熟度モデル</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/observability-best-practices/ja/guides/cloudwatch_cross_account_observability">CloudWatch Cross-Account Observability</a></li></ul></li></ul></nav><button type="button" title="サイドバーを隠す" aria-label="サイドバーを隠す" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/observability-best-practices/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">EKS best practices</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AWS Native</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Amazon EKS API サーバーのモニタリング</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>Amazon EKS API サーバーのモニタリング</h1></header>
<p>オブザーバビリティのベストプラクティスガイドのこのセクションでは、API サーバーのモニタリングに関連する以下のトピックについて詳しく説明します：</p>
<ul>
<li>Amazon EKS API サーバーのモニタリングの概要</li>
<li>API サーバートラブルシューターダッシュボードの設定</li>
<li>API トラブルシューターダッシュボードを使用した API サーバーの問題の理解</li>
<li>API サーバーへの無制限のリスト呼び出しの理解</li>
<li>API サーバーへの不適切な動作の停止</li>
<li>API の優先順位と公平性</li>
<li>最も遅い API 呼び出しと API サーバーのレイテンシー問題の特定</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="はじめに">はじめに<a href="#はじめに" class="hash-link" aria-label="はじめに への直接リンク" title="はじめに への直接リンク">​</a></h3>
<p>Amazon EKS のマネ ージドコントロールプレーンのモニタリングは、EKS クラスターの健全性に関する問題を事前に特定するための重要な Day 2 の運用活動です。Amazon EKS コントロールプレーンのモニタリングは、収集されたメトリクスに基づいて事前対策を講じるのに役立ちます。これらのメトリクスは、API サーバーのトラブルシューティングや、問題の根本原因の特定に役立ちます。</p>
<p>このセクションでは、Amazon EKS API サーバーのモニタリングに Amazon Managed Service for Prometheus (AMP) を、メトリクスの可視化に Amazon Managed Grafana (AMG) を使用してデモンストレーションを行います。Prometheus は人気のあるオープンソースのモニタリングツールで、強力なクエリ機能を提供し、さまざまなワークロードに幅広くサポートされています。Amazon Managed Service for Prometheus は、完全マネージド型の Prometheus 互換サービスで、Amazon EKS、<a href="https://aws.amazon.com/jp/ecs" target="_blank" rel="noopener noreferrer">Amazon Elastic Container Service (Amazon ECS)</a>、<a href="https://aws.amazon.com/jp/ec2" target="_blank" rel="noopener noreferrer">Amazon Elastic Compute Cloud (Amazon EC2)</a> などの環境を安全かつ確実にモニタリングすることを容易にします。<a href="https://aws.amazon.com/jp/grafana/" target="_blank" rel="noopener noreferrer">Amazon Managed Grafana</a> は、オープンソースの Grafana 用の完全マネージド型で安全なデータ可視化サービスで、顧客が複数のデータソースからアプリケーションの運用メトリクス、ログ、トレースを即座にクエリ、相関付け、可視化することを可能にします。</p>
<p>まず、Amazon Managed Service for Prometheus と Amazon Managed Grafana を使用してスターターダッシュボードを設定し、Prometheus を使用して <a href="https://aws.amazon.com/jp/eks" target="_blank" rel="noopener noreferrer">Amazon Elastic Kubernetes Service (Amazon EKS)</a> API サーバーのトラブルシューティングを支援します。続くセクションでは、EKS API サーバーのトラブルシューティング中の問題の理解、API の優先順位と公平性、不適切な動作の停止について詳しく説明します。最後に、最も遅い API 呼び出しと API サーバーのレイテンシーの問題を特定する方法を深く掘り下げ、Amazon EKS クラスターの健全な状態を維持するためのアクションを取るのに役立ちます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-サーバーのトラブルシューティング-ダッシュボードの設定">API サーバーのトラブルシューティング ダッシュボードの設定<a href="#api-サーバーのトラブルシューティング-ダッシュボードの設定" class="hash-link" aria-label="API サーバーのトラブルシューティング ダッシュボードの設定 への直接リンク" title="API サーバーのトラブルシューティング ダッシュボードの設定 への直接リンク">​</a></h3>
<p>AMP を使用して <a href="https://aws.amazon.com/jp/eks" target="_blank" rel="noopener noreferrer">Amazon Elastic Kubernetes Service (Amazon EKS)</a> API サーバーのトラブルシューティングを支援するスターター ダッシュボードを設定します。これを使用して、本番環境の EKS クラスターのトラブルシューティング時にメトリクスを理解するのに役立てます。さらに、収集されたメトリクスに深く焦点を当て、Amazon EKS クラスターのトラブルシューティング時のその重要性を理解します。</p>
<p>まず、<a href="https://aws.amazon.com/jp/blogs/news/metrics-and-traces-collection-using-amazon-eks-add-ons-for-aws-distro-for-opentelemetry/" target="_blank" rel="noopener noreferrer">ADOT コレクターを設定して Amazon EKS クラスターから Amazon Manager Service for Prometheus にメトリクスを収集</a>します。このセットアップでは、EKS ADOT アドオンを使用します。これにより、ユーザーは EKS クラスターが稼働した後いつでも ADOT をアドオンとして有効にできます。ADOT アドオンには最新のセキュリティパッチとバグ修正が含まれており、Amazon EKS で動作することが AWS によって検証されています。このセットアップでは、EKS クラスターに ADOT アドオンをインストールし、それを使用してクラスターからメトリクスを収集する方法を示します。</p>
<p>次に、最初のステップで設定したデータソースとして AMP を使用して<a href="https://aws.amazon.com/jp/blogs/news/amazon-managed-grafana-getting-started/" target="_blank" rel="noopener noreferrer">メトリクスを可視化するために Amazon Managed Grafana ワークスペースを設定</a>します。最後に、<a href="https://github.com/RiskyAdventure/Troubleshooting-Dashboards/blob/main/api-troubleshooter.json" target="_blank" rel="noopener noreferrer">API トラブルシューター ダッシュボード</a>をダウンロードし、Amazon Managed Grafana に移動して API トラブルシューター ダッシュボードの JSON をアップロードし、さらなるトラブルシューティングのためにメトリクスを可視化します。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-トラブルシューターダッシュボードを使用して問題を理解する">API トラブルシューターダッシュボードを使用して問題を理解する<a href="#api-トラブルシューターダッシュボードを使用して問題を理解する" class="hash-link" aria-label="API トラブルシューターダッシュボードを使用して問題を理解する への直接リンク" title="API トラブルシュー  ターダッシュボードを使用して問題を理解する への直接リンク">​</a></h3>
<p>クラスターにインストールしたい興味深いオープンソースプロジェクトを見つけたとしましょう。そのオペレーターは、クラスターに DaemonSet をデプロイします。この DaemonSet は、不正な形式のリクエストを使用したり、不必要に多くの LIST 呼び出しを行ったり、あるいは 1,000 ノードすべてにある各 DaemonSet が、クラスター上の 50,000 個すべての Pod のステータスを毎分リクエストしたりする可能性があります。</p>
<p>これは本当によく起こることでしょうか？はい、実際によく起こります！このような状況がどのように発生するのか、簡単に見てみましょう。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="list-と-watch-の理解">LIST と WATCH の理解<a href="#list-と-watch-の理解" class="hash-link" aria-label="LIST と WATCH の理解 への直接リンク" title="LIST と WATCH の理解 への直接リンク">​</a></h4>
<p>一部のアプリケーションでは、クラスター内のオブジェクトの状態を理解する必要があります。例えば、機械学習 (ML) アプリケーションが、<em>Completed</em> ステータスになっていない Pod の数を把握することでジョブのステータスを知りたい場合があります。Kubernetes では、これを行うための適切な方法として WATCH と呼ばれるものがあります。一方で、クラスター上のすべてのオブジェクトをリストアップして Pod の最新ステータスを見つけるという、あまり適切ではない方法もあります。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="適切に動作する-watch">適切に動作する WATCH<a href="#適切に動作する-watch" class="hash-link" aria-label="適切に動作する WATCH への直接リンク" title="適切  に動作する WATCH への直接リンク">​</a></h4>
<p>WATCH または単一の長期接続を使用して、プッシュモデルで更新を受け取ることは、Kubernetes で更新を行う最もスケーラブルな方法です。簡単に言えば、システムの完全な状態を要求し、そのオブジェクトに変更が受信されたときにのみキャッシュ内のオブジェクトを更新し、定期的に再同期を実行して更新が見逃されていないことを確認します。</p>
<p>以下の画像では、<code>apiserver_longrunning_gauge</code> を使用して、両方の API サーバーにわたるこれらの長期接続の数を把握しています。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-1" src="/observability-best-practices/ja/assets/images/api-mon-1-6beca6db67fd83b66ee810e950a174a0.jpg" width="1613" height="361" class="img_ev3q"></p>
<p><em>図：<code>apiserver_longrunning_gauge</code> メトリクス</em></p>
<p>このような効率的なシステムでも、良いものを過剰に持つことがあります。例えば、API サーバーと通信する必要がある 2 つ以上の DaemonSet を使用する非常に小さなノードを多数使用する場合、システム上の WATCH 呼び出しの数を不必要に劇的に増加させることは簡単です。例えば、8 つの xlarge ノードと 1 つの 8xlarge ノードの違いを見てみましょう。ここでは、システム上の WATCH 呼び出しが 8 倍に増加しているのが分かります。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-2" src="/observability-best-practices/ja/assets/images/api-mon-2-319b357b94ac8442fd7e15809db19003.jpg" width="921" height="415" class="img_ev3q"></p>
<p><em>図：8 つの xlarge ノード間の WATCH 呼び出し</em></p>
<p>これらは効率的な呼び出しですが、もし代わりに先ほど言及した不適切な動作をする呼び出しだったらどうでしょうか？1,000 個のノードそ れぞれの上記の DaemonSet の 1 つが、クラスター内の合計 50,000 個の Pod それぞれの更新を要求していると想像してください。次のセクションでは、この無制限のリスト呼び出しのアイデアを探ります。</p>
<p>続ける前に注意点を一つ。上記の例のような統合は非常に慎重に行う必要があり、他にも多くの要因を考慮する必要があります。システム上の限られた数の CPU を争う多数のスレッドの遅延、Pod の変更率、ノードが安全に処理できるボリュームアタッチメントの最大数など、すべてが関係します。しかし、私たちの焦点は、問題の発生を防ぐための実行可能な手順につながるメトリクスに置かれます。そして、おそらく私たちの設計に新しい洞察を与えてくれるでしょう。</p>
<p>WATCH メトリクスはシンプルですが、WATCH の数を追跡し、それが問題である場合は削減するために使用できます。以下は、この数を減らすために検討できるいくつかのオプションです：</p>
<ul>
<li>Helm が履歴を追跡するために作成する ConfigMap の数を制限する</li>
<li>WATCH を使用しない不変の ConfigMap と Secret を使用する</li>
<li>適切なノードのサイジングと統合</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-サーバーへの無制限のリスト呼び出しを理解する">API サーバーへの無制限のリスト呼び出しを理解する<a href="#api-サーバーへの無制限のリスト呼び出しを理解する" class="hash-link" aria-label="API サーバーへの無制限のリスト呼び出しを理解する への直接リンク" title="API サーバーへの無制限のリスト呼び出しを理解する への直接リンク">​</a></h3>
<p>さて、これまで話してきた LIST 呼び出しについて説明します。リスト呼び出しは、オブジェ クトの状態を理解する必要がある度に、Kubernetes オブジェクトの完全な履歴を取得します。今回はキャッシュに何も保存されません。</p>
<p>これはどの程度影響があるのでしょうか？それは、データを要求するエージェントの数、要求の頻度、要求するデータ量によって異なります。クラスター全体のデータを要求しているのか、それとも単一の名前空間だけなのでしょうか？それは毎分、すべてのノードで発生するのでしょうか？ノードから送信されるすべてのログに Kubernetes のメタデータを追加するロギングエージェントの例を使ってみましょう。これは、大規模なクラスターでは膨大な量のデータになる可能性があります。エージェントがリスト呼び出しを通じてそのデータを取得する方法は多数ありますので、いくつか見てみましょう。</p>
<p>以下のリクエストは、特定の名前空間からポッドを要求しています。</p>
<p><code>/api/v1/namespaces/my-namespace/pods</code></p>
<p>次に、クラスター上の 50,000 個のポッドすべてを要求しますが、一度に 500 個のポッドずつ取得します。</p>
<p><code>/api/v1/pods?limit=500</code></p>
<p>次の呼び出しが最も破壊的です。クラスター全体の 50,000 個のポッドを一度に取得します。</p>
<p><code>/api/v1/pods</code></p>
<p>これは現場でよく発生し、ログで確認できます。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-サーバーへの不適切な動作を停止する">API サーバーへの不適切な動作を停止する<a href="#api-サーバーへの不適切な動作を停止する" class="hash-link" aria-label="API サーバーへの不適切な動作を停止する への直接リンク" title="API サーバーへの不適切な動作を停止する への直接リンク">​</a></h3>
<p>このよう  な不適切な動作からクラスターを保護するにはどうすればよいでしょうか？Kubernetes 1.20 以前では、API サーバーは 1 秒あたりに処理される <em>インフライト</em> リクエストの数を制限することで自身を保護していました。etcd は一度に処理できるリクエスト数に限りがあるため、etcd の読み取りと書き込みを適切なレイテンシー範囲内に保つために、1 秒あたりのリクエスト数を制限する必要があります。残念ながら、この記事を書いている時点では、これを動的に行う方法はありません。</p>
<p>以下のチャートでは、読み取りリクエストの内訳を示しています。デフォルトでは API サーバーあたり最大 400 のインフライトリクエストと、最大 200 の同時書き込みリクエストが設定されています。デフォルトの EKS クラスターでは、2 つの API サーバーがあり、合計で 800 の読み取りと 400 の書き込みが可能です。ただし、これらのサーバーは、アップグレード直後などの異なる時間帯で非対称な負荷がかかる可能性があるため、注意が必要です。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-3" src="/observability-best-practices/ja/assets/images/api-mon-3-1f15dc0e228fff08b1ee9d167b6f7411.jpg" width="1292" height="536" class="img_ev3q"></p>
<p><em>図：読み取りリクエストの内訳を示す Grafana チャート</em></p>
<p>上記の方式は完璧ではないことが判明しました。例えば、新しくインストールした不適切な動作をするオペレーターが API サーバーのインフライト書き込みリクエストをすべて占有し、ノードのキープアライブメッセージなどの重要なリクエストを遅延させる可能性があります。これをどのように防ぐことができるでしょうか？</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-の優先順位と公平性">API の優先順位と公平性<a href="#api-の優先順位と公平性" class="hash-link" aria-label="API の優先順位と公平性 への直接リンク" title="API の優先順位と公平性 への直接リンク">​</a></h3>
<p>1 秒あたりの読み取り/書き込みリクエスト数を心配するのではなく、キャパシティを 1 つの総数として扱い、クラスター上の各アプリケーションがその最大総数の公平な割合またはシェアを得るとしたらどうでしょうか？</p>
<p>これを効果的に行うには、API サーバーにリクエストを送信した人を特定し、そのリクエストに一種の名前タグを付ける必要があります。この新しい名前タグを使用すると、これらのリクエストがすべて「Chatty」と呼ぶ新しいエージェントから来ていることがわかります。これで、Chatty のすべてのリクエストを <em>フロー</em> と呼ばれるものにグループ化し、それらのリクエストが同じ DaemonSet から来ていることを識別できます。この概念により、この悪いエージェントを制限し、クラスター全体を消費しないようにする能力が得られます。</p>
<p>しかし、すべてのリクエストが平等に作成されているわけではありません。クラスターの運用に必要なコントロールプレーントラフィックは、新しいオペレーターよりも優先度が高くあるべきです。ここで優先度レベルの概念が登場します。デフォルトで、重要、高、低優先度のトラフィック用に複数の「バケット」またはキューがあったらどうでしょうか？ おしゃべりなエージェントのフローが重要なトラフィックキューで公平なシェアを得ることは望ましくありません。しかし、そのトラフィックを低優先度キューに入れることで、 そのフローが他のおしゃべりなエージェントと競合するようにすることができます。そして、各優先度レベルが API サーバーが処理できる全体の最大値の適切な数のシェアまたは割合を持つようにして、リクエストが過度に遅延しないようにしたいと考えます。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="優先順位と公平性の実践">優先順位と公平性の実践<a href="#優先順位と公平性の実践" class="hash-link" aria-label="優先順位と公平性の実践 への直接リンク" title="優先順位と公平性の実践 への直接リンク">​</a></h4>
<p>これは比較的新しい機能であるため、多くの既存のダッシュボードでは、最大同時読み取り数と最大同時書き込み数の古いモデルを使用しています。なぜこれが問題になる可能性があるのでしょうか？</p>
<p>kube-system 名前空間内のすべてのものに高優先度の名前タグを付けていたとしても、その重要な名前空間に問題のあるエージェントをインストールしたり、単にその名前空間に多くのアプリケーションをデプロイしすぎたりしたらどうなるでしょうか？避けようとしていた問題と同じ問題が発生する可能性があります！そのため、このような状況には注意を払う必要があります。</p>
<p>このような問題を追跡するために最も興味深いと思われるメトリクスをいくつか挙げてみました。</p>
<ul>
<li>優先度グループのシェアのうち、何パーセントが使用されているか？</li>
<li>リクエストがキューで待機した最長時間は？</li>
<li>どのフローが最も多くのシェアを使用しているか？</li>
<li>システムに予期せぬ遅延はあるか？</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用率">使用率<a href="#使用率" class="hash-link" aria-label="使用率 への直接リンク" title="使用率 への直接リンク">​</a></h4>
<p>ここでは、クラスター上の異なるデフォルトの優先度グループと、最大値に対する使用率のパーセンテージを確認できます。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-4" src="/observability-best-practices/ja/assets/images/api-mon-4-fc5a08408f764524f2960e1b0e6d8352.jpg" width="1652" height="424" class="img_ev3q"></p>
<p><em>図：クラスター上の優先度グループ</em></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="リクエストがキューに入っていた時間">リクエストがキューに入っていた時間<a href="#リクエストがキューに入っていた時間" class="hash-link" aria-label="リクエストがキューに入っていた時間 への直接リンク" title="リクエストがキューに入っていた時間 への直接リンク">​</a></h4>
<p>リクエストが処理される前に優先度キューに入っていた時間（秒単位）。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-5" src="/observability-best-practices/ja/assets/images/api-mon-5-b3d3c2243725460655927eba3379e00f.jpg" width="999" height="369" class="img_ev3q"></p>
<p><em>図：リクエストが優先度キューに入っていた時間。</em></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="フローごとの最も実行されたリクエスト">フローごとの最も実行されたリクエスト<a href="#フローごとの最も実行されたリクエスト" class="hash-link" aria-label="フローごとの最も実行されたリクエスト への直接リンク" title="フローごとの最も実行されたリクエスト への直接リンク">​</a></h4>
<p>どのフローが最も多くのシェアを占めているでしょうか？</p>
<p><img decoding="async" loading="lazy" alt="API-MON-6" src="/observability-best-practices/ja/assets/images/api-mon-6-99bad57bd277923055a5074b247259e1.jpg" width="967" height="371" class="img_ev3q"></p>
<p><em>図：フローごとの最も実行されたリクエスト</em></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="リクエスト実行時間">リクエスト実行時間<a href="#リクエスト実行時間" class="hash-link" aria-label="リクエスト実行時間 への直接リンク" title="リクエスト実行時間 への直接リンク">​</a></h4>
<p>処理に予期せぬ遅延はありませんか？</p>
<p><img decoding="async" loading="lazy" alt="API-MON-7" src="/observability-best-practices/ja/assets/images/api-mon-7-0b77723bbfea585d2bf33f2f43f8cd5e.jpg" width="976" height="369" class="img_ev3q"></p>
<p><em>図：フロー制御リクエスト実行時間</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="最も遅い-api-コールと-api-サーバーのレイテンシー問題の特定">最も遅い API コールと API サーバーのレイテンシー問題の特定<a href="#最も遅い-api-コールと-api-サーバーのレイテンシー問題の特定" class="hash-link" aria-label="最も遅い API コールと API サーバーのレイテンシー問題の特定 への直接リンク" title="最も遅い API コールと API サーバーのレイテンシー問題の特定 への直接リンク">​</a></h3>
<p>API のレイテンシーを引き起こす要因を理解したところで、全体像を見てみましょう。ダッシュボードのデザインは、調査すべき問題があるかどうかを素早く把握するためのものであることを覚えておくことが重要です。詳細な分析には、PromQL を使用したアドホッククエリ、あるいはさらに良いのはログクエリを使用します。</p>
<p>高レベルのメトリクスとして、どのようなものを見るべきでしょうか？以下にいくつかのアイデアを示します：</p>
<ul>
<li>完了までに最も時間がかかっている API コールは何か？<!-- -->
<ul>
<li>そのコールは何をしてい  るのか？（オブジェクトのリスト化、削除など）</li>
<li>どのオブジェクトに対してその操作を行おうとしているのか？（Pod、Secret、ConfigMap など）</li>
</ul>
</li>
<li>API サーバー自体にレイテンシーの問題があるか？<!-- -->
<ul>
<li>優先度キューの1つに遅延があり、リクエストのバックアップを引き起こしているか？</li>
</ul>
</li>
<li>etcd サーバーがレイテンシーを経験しているために API サーバーが遅く見えるだけなのか？</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="最も遅い-api-コール">最も遅い API コール<a href="#最も遅い-api-コール" class="hash-link" aria-label="最も遅い API コール への直接リンク" title="最も遅い API コール への直接リンク">​</a></h4>
<p>以下のチャートでは、その期間で完了までに最も時間がかかった API コールを確認しています。この場合、カスタムリソース定義 (CRD) が LIST 関数を呼び出しており、05:40 の時間枠で最も遅延の大きいコールであることがわかります。このデータを基に、CloudWatch Insights を使用して、その時間枠内の監査ログから LIST リクエストを抽出し、どのアプリケーションが関係しているかを確認できます。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-8" src="/observability-best-practices/ja/assets/images/api-mon-8-b05232ee0fadf479574e6e80f429825d.jpg" width="941" height="409" class="img_ev3q"></p>
<p><em>図：最も遅い上位 5 つの API コール。</em></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="api-リクエスト時間">API リクエスト時間<a href="#api-リクエスト時間" class="hash-link" aria-label="API リクエスト時間 への直接リンク" title="API リクエスト時間 への直接リンク">​</a></h4>
<p>この API レイテンシーチャートは、リクエストが 1 分のタイ ムアウト値に近づいているかどうかを理解するのに役立ちます。以下の時系列ヒストグラムは、折れ線グラフでは隠れてしまう外れ値を見ることができるため、私はこの形式が好きです。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-9" src="/observability-best-practices/ja/assets/images/api-mon-9-90c5abd6685cd0b05e2f38876d648d2a.jpg" width="845" height="416" class="img_ev3q"></p>
<p><em>図：API リクエスト時間のヒートマップ。</em></p>
<p>バケットにカーソルを合わせるだけで、約 25 ミリ秒かかった呼び出しの正確な数を確認できます。
[Image: Image.jpg]<em>図：25 ミリ秒を超える呼び出し。</em></p>
<p>この概念は、リクエストをキャッシュする他のシステムと連携する際に重要です。キャッシュリクエストは高速であり、これらのリクエストレイテンシーを遅いリクエストと混同したくありません。ここでは、レイテンシーの 2 つの異なるバンドを見ることができます。キャッシュされたリクエストと、されていないリクエストです。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-10" src="/observability-best-practices/ja/assets/images/api-mon-10-951cb182ad00cf55c12c569f53a8f6f7.jpg" width="774" height="229" class="img_ev3q"></p>
<p><em>図：レイテンシー、キャッシュされたリクエスト。</em></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="etcd-リクエスト時間">ETCD リクエスト時間<a href="#etcd-リクエスト時間" class="hash-link" aria-label="ETCD リクエスト時間 への直接リンク" title="ETCD リクエスト時間 への直接リンク">​</a></h4>
<p>ETCD のレイテンシーは、Kubernetes のパフォーマンスにおいて最も重要な要素の 1 つです。Amazon EKS では、<code>request_duration_seconds_bucket</code> メトリクスを確認することで、API サーバーの視点か  らこのパフォーマンスを見ることができます。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-11" src="/observability-best-practices/ja/assets/images/api-mon-11-41907cb5ef379332cd272ba6e67191e6.jpg" width="886" height="440" class="img_ev3q"></p>
<p><em>図：<code>request_duration_seconds_bucket</code> メトリクス</em></p>
<p>これまで学んだことを組み合わせて、特定のイベントが相関しているかどうかを確認することができます。以下のチャートでは、API サーバーのレイテンシーを確認できますが、このレイテンシーの多くが etcd サーバーから来ていることもわかります。一目で適切な問題領域にすぐに移動できることが、ダッシュボードの強力な点です。</p>
<p><img decoding="async" loading="lazy" alt="API-MON-12" src="/observability-best-practices/ja/assets/images/api-mon-12-ce420a9849f95a4d8d12af13860b91c8.jpg" width="871" height="473" class="img_ev3q"></p>
<p><em>図：Etcd リクエスト</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="結論">結論<a href="#結論" class="hash-link" aria-label="結論 への直接リンク" title="結論 への直接リンク">​</a></h2>
<p>Observability のベストプラクティスガイドのこのセクションでは、Amazon Managed Service for Prometheus と Amazon Managed Grafana を使用した<a href="https://github.com/RiskyAdventure/Troubleshooting-Dashboards/blob/main/api-troubleshooter.json" target="_blank" rel="noopener noreferrer">スターターダッシュボード</a>を利用して、<a href="https://aws.amazon.com/jp/eks" target="_blank" rel="noopener noreferrer">Amazon Elastic Kubernetes Service (Amazon EKS)</a> API サーバーのトラブルシューティングを支援しました。</p>
<p>さらに、EKS API サーバーのトラブルシューティング中の問題の理解、API の優先順位と公平性、不適切な動作の停止について詳しく掘り下げました。</p>
<p>最後に、最も遅い API コールの特定と API サーバーのレイテンシーの問題を深く掘り下げました。これにより、Amazon EKS クラスターの状態を健全に保つためのアクションを取ることができます。</p>
<p>さらに深く掘り下げるには、AWS <a href="https://catalog.workshops.aws/observability/en-US" target="_blank" rel="noopener noreferrer">One Observability Workshop</a> の AWS ネイティブ Observability カテゴリーにあるアプリケーションモニタリングモジュールを実践することを強くお勧めします。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/aws-observability/observability-best-practices/blob/main/docusaurus/docs/guides/containers/aws-native/eks/eks-api-server-monitoring.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/observability-best-practices/ja/guides/containers/aws-native/eks/log-aggregation"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">ログ集約</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/observability-best-practices/ja/guides/containers/aws-native/eks/container-tracing-with-aws-xray"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">AWS X-Ray によるコンテナトレーシング</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#はじめに" class="table-of-contents__link toc-highlight">はじめに</a></li><li><a href="#api-サーバーのトラブルシューティング-ダッシュボードの設定" class="table-of-contents__link toc-highlight">API サーバーのトラブルシューティング ダッシュボードの設定</a></li><li><a href="#api-トラブルシューターダッシュボードを使用して問題を理解する" class="table-of-contents__link toc-highlight">API トラブルシューターダッシュボードを使用して問題を理解する</a></li><li><a href="#api-サーバーへの無制限のリスト呼び出しを理解する" class="table-of-contents__link toc-highlight">API サーバーへの無制限のリスト呼び出しを理解する</a></li><li><a href="#api-サーバーへの不適切な動作を停止する" class="table-of-contents__link toc-highlight">API サーバーへの不適切な動作を停止する</a></li><li><a href="#api-の優先順位と公平性" class="table-of-contents__link toc-highlight">API の優先順位と公平性</a></li><li><a href="#最も遅い-api-コールと-api-サーバーのレイテンシー問題の特定" class="table-of-contents__link toc-highlight">最も遅い API コールと API サーバーのレイテンシー問題の特定</a></li><li><a href="#結論" class="table-of-contents__link toc-highlight">結論</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2025.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>